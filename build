#!/usr/bin/env bash

args=( \
  "adoptopenjdk:11.0.9.1_1-jre-hotspot-focal 2.6.0 2.12 1" \
  "adoptopenjdk:11.0.9.1_1-jre-hotspot-focal 2.6.0 2.13 1" \
  "adoptopenjdk:11.0.9.1_1-jre-hotspot-focal 2.7.0 2.12 1" \
  "adoptopenjdk:11.0.9.1_1-jre-hotspot-focal 2.7.0 2.13 1" \
)

for a in "${args[@]}"
do
  IFS=" " read -r -a img_args <<< "${a}"
  jre="${img_args[0]}"
  kafka="${img_args[1]}"
  scala="${img_args[2]}"
  revision="${img_args[3]}"
  docker build . \
    --build-arg jre="${jre}" \
    --build-arg kafka_version="${kafka}" \
    --build-arg scala_version="${scala}" \
    --tag "moukoublen/kafka:${scala}-${kafka}_${revision}"
done

for a in "${args[@]}"
do
  IFS=" " read -r -a img_args <<< "${a}"
  kafka="${img_args[1]}"
  scala="${img_args[2]}"
  revision="${img_args[3]}"
  docker push "moukoublen/kafka:${scala}-${kafka}_${revision}"
done
